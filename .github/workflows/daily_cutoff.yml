name: Daily Absent Cutoff

on:
  schedule:
    # 1. ‡∏£‡∏±‡∏ô‡∏ï‡∏≠‡∏ô‡πÄ‡∏ä‡πâ‡∏≤ (03:00 UTC = 10:00 ‡∏ô. ‡πÑ‡∏ó‡∏¢) ‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏ö‡∏≤‡∏á‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏ä‡πâ‡∏≤
    - cron: '0 3 * * *' 
    
    # 2. ‡∏£‡∏±‡∏ô‡∏ó‡∏∏‡∏Å 30 ‡∏ô‡∏≤‡∏ó‡∏µ ‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏ö‡πà‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á‡πÄ‡∏¢‡πá‡∏ô (08:00 - 13:00 UTC)
    # üí° ‡∏ä‡πà‡∏ß‡∏á‡∏ô‡∏µ‡πâ‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°‡πÄ‡∏ß‡∏•‡∏≤ 15:00 ‡∏ô. ‡∏ñ‡∏∂‡∏á 20:00 ‡∏ô. ‡πÑ‡∏ó‡∏¢
    # ‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ô‡∏ñ‡∏µ‡πà ‡πÜ ‡∏à‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏±‡∏î‡∏¢‡∏≠‡∏î‡∏ï‡∏≤‡∏°‡πÄ‡∏ß‡∏•‡∏≤ 17:00 ‡∏ô. ‡πÉ‡∏ô Setting Page ‡πÑ‡∏î‡πâ "‡∏ó‡∏±‡∏ô‡∏ó‡∏µ" ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ñ‡∏∂‡∏á‡πÄ‡∏Å‡∏ì‡∏ë‡πå
    - cron: '0,30 8-13 * * *' 
    
  workflow_dispatch: # ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì‡∏Å‡∏î‡∏£‡∏±‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏°‡∏∑‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÑ‡∏î‡πâ
# ----------------------------------------------------------------------

jobs:
  cutoff:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '18'

      - name: Install Dependencies
        run: npm install firebase-admin dayjs

      - name: Run Cutoff Script
        env:
          # ‡∏î‡∏∂‡∏á Secret Key ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Firebase
          FIREBASE_SERVICE_ACCOUNT: ${{ secrets.FIREBASE_SERVICE_ACCOUNT }}
        run: node scripts/auto-cutoff.js